<!DOCTYPE html>
<html>

<head>
<!--
<script src="https://tonejs.github.io/build/Tone.min.js"></script>
-->
<script src="https://cdnjs.cloudflare.com/ajax/libs/tone/13.4.10/Tone.min.js"></script>

<style>

	body {
		background: #242;
	}


</style>

</head>

<body>


<button id="start">Start</button>
<button id="stop">Stop</button>



<script>

// goal: a constructor which returns a synthObject with random property assignments
	// can accept an object for testing?
// https://propa.app/
// todo: Why is it needed to trigger the synthesizer before the loop?
// todo: Why doesn't it play when release is assigned '8n'
// todo: caster questions - How fast can you speak/How many commands in a row/Different types of commands? 
		//commands for: comment, new, 

// https://codepen.io/gntsketches/pen/KjVdBm?editors=1010


function SynthBuilder() {
	this.synth = new Tone.Synth({
		oscillator  : {
			type  : 'sawtooth'
		},
		envelope  : {
			attack  : '8n',		
			decay  : 0,
			sustain  : 1,
			release  : 0.5
		} // https://tonejs.github.io/docs/r13/Type#time // can hook to transport
	})

	this.vibrato = new Tone.Vibrato()
	this.vibrato.toMaster()
	this.synthObject.connect(this.vibrato)
	this.lfo = new Tone.LFO(0.125, 0, 0.25)
	this.lfo.connect(this.vibrato.depth)
	this.lfo.start()
	return this.synthObject
};

var synth = new SynthBuilder()

var loop = new Tone.Loop(function (time) {
	console.log(time)
	synth.triggerAttackRelease('g1', '4n')
})

Tone.Transport.bpm.value = 30
Tone.Transport.start();


document.querySelector('#start').addEventListener('click', () => { 
	synth.triggerAttackRelease('g1', '4n')
	loop.start(0)

})
document.querySelector('#stop').addEventListener('click', () => { 
	loop.stop()

})




/*
var synthObject = new Tone.DuoSynth().toMaster()
synthObject.voice0.oscillator.type = 'sawtooth'
synthObject.voice1.oscillator.type = 'sawtooth'
console.log(synthObject)
var lfo = new Tone.LFO(0.125, 1, 1.5)
lfo.connect(synthObject.harmonicity)


var synthObject = new Tone.Synth()
synthObject.oscillator.type = 'sawtooth'
var vibrato = new Tone.Vibrato()
vibrato.toMaster()
synthObject.connect(vibrato)
var lfo = new Tone.LFO(0.125, 0, 0.25)
lfo.connect(vibrato.depth)


*/















</script>

<html>