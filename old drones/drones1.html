<!DOCTYPE html>
<html>

<head>
<!--
<script src="https://tonejs.github.io/build/Tone.min.js"></script>
-->
<script src="https://cdnjs.cloudflare.com/ajax/libs/tone/13.4.10/Tone.min.js"></script>

<style>

	body {
		background: #242;
	}


</style>

</head>

<body>


<button id="start">Start</button>
<button id="stop">Stop</button>



<script>

// https://propa.app/
// todo: Why is it needed to trigger the synthesizer before the loop?

var synth = new Tone.Synth({
	oscillator  : {
		type  : 'sawtooth'
	},
	envelope  : {
		rise  : 5,
		decay  : 0,
		sustain  : 1,
		release  : 5
	} // https://tonejs.github.io/docs/r13/Type#time // can hook to transport
})
var vibrato = new Tone.Vibrato()
vibrato.toMaster()
synth.connect(vibrato)
var lfo = new Tone.LFO(0.125, 0, 0.25)
lfo.connect(vibrato.depth)
lfo.start()


var loop = new Tone.Loop(function (time) {
	console.log(time)
	if (Math.floor(time % 10) === 0 ) {
	console.log('trig')
	synth.triggerAttackRelease('g1', 5, time)
	}
})

Tone.Transport.bpm.value = 60
Tone.Transport.start();


document.querySelector('#start').addEventListener('click', () => { 
	synth.triggerAttackRelease('g1', '4n')
	loop.start(0)

})
document.querySelector('#stop').addEventListener('click', () => { 
	loop.stop()

})




/*
var synthObject = new Tone.DuoSynth().toMaster()
synthObject.voice0.oscillator.type = 'sawtooth'
synthObject.voice1.oscillator.type = 'sawtooth'
console.log(synthObject)
var lfo = new Tone.LFO(0.125, 1, 1.5)
lfo.connect(synthObject.harmonicity)


var synthObject = new Tone.Synth()
synthObject.oscillator.type = 'sawtooth'
var vibrato = new Tone.Vibrato()
vibrato.toMaster()
synthObject.connect(vibrato)
var lfo = new Tone.LFO(0.125, 0, 0.25)
lfo.connect(vibrato.depth)


*/















</script>

<html>